<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Chatbot - Text Generation</title>
    <script type="module" src="https://cdn.jsdelivr.net/npm/@xenova/transformers@latest" onload="initChatbot()"></script>
</head>
<body>
    <h1>AI Chatbot - Text Generation</h1>
    <input type="text" id="userInput" placeholder="Type your message here">
    <button id="submitBtn">Send</button>
    <p><strong>Response:</strong></p>
    <pre id="responseOutput"></pre>

    <script type="module">
        let transformerReady = false;

        // Function to initialize the chatbot
        async function initChatbot() {
            if (window.transformers) {
                transformerReady = true;
                console.log("Transformers.js loaded successfully!");
            } else {
                console.error("Failed to load transformers.js");
            }
        }

        async function submitMessage() {
            const userMessage = document.getElementById("userInput").value;
            const responseOutput = document.getElementById("responseOutput");

            if (!userMessage) {
                responseOutput.textContent = "Please enter a message!";
                return;
            }

            // Logging the input message
            console.log("User Message:", userMessage);
            
            try {
                if (!transformerReady) {
                    responseOutput.textContent = "Transformers.js is not ready yet!";
                    return;
                }

                // Initialize the pipeline for text generation using GPT-2
                const generator = await window.transformers.pipeline('text-generation', 'gpt2');
                console.log("Pipeline initialized:", generator);
                
                // Generate response using the pipeline
                const response = await generator(userMessage);
                console.log("Generated Response:", response);

                // Display the response
                responseOutput.textContent = response[0].generated_text;

            } catch (error) {
                console.error("Error during text generation:", error);
                responseOutput.textContent = "An error occurred while generating the response.";
            }
        }

        // Wait for DOMContentLoaded to initialize event listeners
        document.addEventListener('DOMContentLoaded', () => {
            // Set up event listener for the button click
            document.getElementById('submitBtn').addEventListener('click', submitMessage);
        });
    </script>
</body>
</html>
